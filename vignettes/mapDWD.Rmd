---
title: "DWD weather stations"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{mapDWD}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

[rdwd main vignette](rdwd.html)

The first line of the info box (when you click on a point)
can be copypasted into R to obtain more information on the available files.

Copypaste the following code for a map with faster reaction times than the CRAN html view.

```{r map, fig.height=7, fig.width=7, warning=FALSE}
library(rdwd)  ;  data(mapDWD)  ;  library(leaflet)  ;  mapDWD
```

Many stations have slightly different coordinates, depending on the description metadata file.
They may have been corrected over time, station locations may have actually changed, 
or different variables may be measured at different locations.

All station IDs where the coordinates are no further than 900 m apart (the fix circle radius)
are aggregated and plotted in the position where most datasets are available.
For aggregated stations, the popup infobox `nfiles_coord` entry contains more than one value.

To see every location on the map, open [mapDWD_all.html](mapDWD_all.html).

The blue dots mark stations for which recent files are available 
(with >=1 file in 'recent' folder or 'BIS_DATUM' later than one year ago).
The red dots mark all stations with only historical datasets.

To see only the stations with recent data, use something like the following:

```{r onlyrecent, eval=FALSE}
data("geoIndex")
leaflet(data=geoIndex[geoIndex$recentfile,]) %>% addTiles() %>%
  addCircleMarkers(~long, ~lat, popup=~display, stroke=F)
```

